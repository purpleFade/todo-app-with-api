(this["webpackJsonpreact-typescript-starter-pack"]=this["webpackJsonpreact-typescript-starter-pack"]||[]).push([[0],{16:function(t,e,n){},18:function(t,e,n){"use strict";n.r(e);var o,c=n(1),r=n.n(c),i=n(9),a=n.n(i),u=(n(14),n(15),n(16),n(0)),d=n(5),l=n.n(d);!function(t){t.All="all",t.Active="active",t.Completed="completed"}(o||(o={}));var s=n(3),f=n(4),j=n(2),b="https://mate.academy/students-api";function m(t){return new Promise((function(e){setTimeout(e,t)}))}function p(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o={method:e};return n&&(o.body=JSON.stringify(n),o.headers={"Content-Type":"application/json; charset=UTF-8"}),m(100).then((function(){return fetch(b+t,o)})).then((function(t){if(!t.ok)throw new Error;return t.json()}))}var O,T=function(t){return p(t)},h=function(t,e){return p(t,"POST",e)},v=function(t,e){return p(t,"PATCH",e)},x=function(t){return p(t,"DELETE")},y=function(t){return x("/todos/".concat(t))},C=12048;!function(t){t.cantLoadTodos="Unable to load todos",t.titleIsEmpty="Title should not be empty",t.cantAddTodo="Unable to add a todo",t.cantDeleteTodo="Unable to delete a todo",t.cantUpdateTodo="Unable to update a todo"}(O||(O={}));var g=Object(c.createContext)({todos:[],status:o.All,setTodos:function(){},setStatus:function(){},deleteTodo:function(){},selectedTodoIds:[],setSelectedTodoIds:function(){},handleToggleCompleted:function(){},clearCompleted:function(){},todoTitle:"",setTodoTitle:function(){},tempTodo:null,setTempTodo:function(){},addTodo:function(){},error:null,setError:function(){},loading:!1,setLoading:function(){},updateTodoItem:function(){}}),k=function(t){var e=t.children,n=Object(c.useState)([]),r=Object(j.a)(n,2),i=r[0],a=r[1],d=Object(c.useState)(o.All),l=Object(j.a)(d,2),b=l[0],m=l[1],p=Object(c.useState)([]),T=Object(j.a)(p,2),x=T[0],k=T[1],_=Object(c.useState)(""),N=Object(j.a)(_,2),S=N[0],E=N[1],A=Object(c.useState)(null),I=Object(j.a)(A,2),w=I[0],L=I[1],F=Object(c.useState)(null),D=Object(j.a)(F,2),U=D[0],B=D[1],P=Object(c.useState)(!1),J=Object(j.a)(P,2),M=J[0],H=J[1],R=Object(c.useCallback)((function(t){k((function(e){return[].concat(Object(f.a)(e),[t])})),y(t).then((function(){setTimeout((function(){a((function(e){return e.filter((function(e){return e.id!==t}))}))}),500)})).catch((function(){k((function(e){return e.splice(e.indexOf(t),1),e})),B(O.cantDeleteTodo),setTimeout((function(){return B(null)}),2e3)})).finally((function(){return setTimeout((function(){return k((function(e){return e.splice(e.indexOf(t),1)}))}),500)}))}),[]),G=Object(c.useCallback)((function(t){H(!0),k((function(e){return[].concat(Object(f.a)(e),[t.id])})),function(t){var e=t.id,n=t.title;return v("/todos/".concat(e),{title:n})}(t).then((function(e){a((function(n){var o=Object(f.a)(n),c=o.findIndex((function(e){return e.id===t.id}));return o.splice(c,1,e),o}))})).catch((function(){B(O.cantUpdateTodo),setTimeout((function(){return B(null)}),2e3)})).finally((function(){H(!1),k((function(e){return e.filter((function(e){return e!==t.id}))}))}))}),[]),K=Object(c.useCallback)((function(){var t=i.filter((function(t){return t.completed}));k((function(e){return[].concat(Object(f.a)(e),Object(f.a)(t.map((function(t){return t.id}))))})),t.map((function(t){return y(t.id)})),setTimeout((function(){a((function(t){return t.filter((function(t){return!t.completed}))}))}),500)}),[i]),W=Object(c.useCallback)((function(t){k((function(e){return[].concat(Object(f.a)(e),[t.id])}));var e=Object(s.a)(Object(s.a)({},t),{},{completed:!t.completed});(function(t){var e=t.id,n=t.completed;return v("/todos/".concat(e),{completed:n})})(e).then((function(t){a((function(n){var o=Object(f.a)(n),c=o.findIndex((function(t){return t.id===e.id}));return o.splice(c,1,t),o}))})).finally((function(){return setTimeout((function(){return k((function(e){var n=Object(f.a)(e);return n.splice(e.indexOf(t.id),1),n}))}))}))}),[]),q=function(t){H(!0),k((function(t){return[].concat(Object(f.a)(t),[0])})),L({id:0,userId:C,title:t,completed:!1}),function(t){var e=t.userId,n=t.title,o=t.completed;return h("/todos",{userId:e,title:n,completed:o})}({userId:C,title:t,completed:!1}).then((function(t){E(""),setTimeout((function(){a((function(e){return[].concat(Object(f.a)(e),[t])}))}),500)})).catch((function(){k((function(t){return t.filter((function(t){return 0!==t}))})),B(O.cantAddTodo),setTimeout((function(){return B(null)}),2e3)})).finally((function(){H(!1),k((function(t){return t.filter((function(t){return 0!==t}))})),setTimeout((function(){return L(null)}),500)}))},z=Object(c.useMemo)((function(){return{todos:i,status:b,setTodos:a,setStatus:m,deleteTodo:R,selectedTodoIds:x,setSelectedTodoIds:k,handleToggleCompleted:W,clearCompleted:K,todoTitle:S,setTodoTitle:E,tempTodo:w,setTempTodo:L,addTodo:q,error:U,setError:B,loading:M,setLoading:H,updateTodoItem:G}}),[i,b,x,R,W,K,S,w,U,M]);return Object(u.jsx)(g.Provider,{value:z,children:e})},_=function(t){var e=t.uncompletedTodosCount,n=t.status,r=t.setStatus,i=t.isSomeTodosCompleted,a=Object(c.useContext)(g).clearCompleted;return Object(u.jsxs)("footer",{className:"todoapp__footer","data-cy":"Footer",children:[Object(u.jsx)("span",{className:"todo-count","data-cy":"TodosCounter",children:"".concat(e," items left")}),Object(u.jsxs)("nav",{className:"filter","data-cy":"Filter",children:[Object(u.jsx)("a",{href:"#/",className:l()("filter__link",{selected:n===o.All}),"data-cy":"FilterLinkAll",onClick:function(){return r(o.All)},children:"All"}),Object(u.jsx)("a",{href:"#/active",className:l()("filter__link",{selected:n===o.Active}),"data-cy":"FilterLinkActive",onClick:function(){return r(o.Active)},children:"Active"}),Object(u.jsx)("a",{href:"#/completed",className:l()("filter__link",{selected:n===o.Completed}),"data-cy":"FilterLinkCompleted",onClick:function(){return r(o.Completed)},children:"Completed"})]}),Object(u.jsx)("button",{type:"button",className:l()("todoapp__clear-completed",{disabled:!i}),"data-cy":"ClearCompletedButton",disabled:!i,onClick:a,children:"Clear completed"})]})},N=function(t){var e=t.todo,n=Object(c.useContext)(g),o=n.todos,r=n.setTodos,i=n.updateTodoItem,a=e.id,d=e.title,f=e.completed,b=Object(c.useState)(d),m=Object(j.a)(b,2),p=m[0],O=m[1],T=Object(c.useState)(!1),h=Object(j.a)(T,2),v=h[0],x=h[1],C=Object(c.useState)(!1),k=Object(j.a)(C,2),_=k[0],N=k[1],S=Object(c.useState)(!1),E=Object(j.a)(S,2),A=E[0],I=E[1],w=Object(c.useRef)(null);Object(c.useEffect)((function(){w.current&&w.current.focus()}),[v]);var L=function(){I(!0),y(a).then((function(){r(o.filter((function(t){return t.id!==a})))})).finally((function(){I(!1)})),r(o.filter((function(t){return t.id!==a})))},F=function(t){if(t.trim())if(t.trim()!==d){N(!0);var n=Object(s.a)(Object(s.a)({},e),{},{title:t.trim()});t.trim()!==d?(i(n),O(t.trim()),x(!1),N(!1)):(x(!1),N(!1))}else x(!1);else L()};return Object(u.jsxs)("div",{className:l()("todo",{completed:!v&&f}),children:[Object(u.jsx)("label",{className:"todo__status-label",children:Object(u.jsx)("input",{"data-cy":"TodoStatus",type:"checkbox",className:"todo__status",onChange:function(){r(o.map((function(t){return t.id===a?Object(s.a)(Object(s.a)({},t),{},{completed:!f}):t})))},checked:f})}),v?Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("form",{onSubmit:function(t){t.preventDefault(),F(p),x(!1)},children:Object(u.jsx)("input",{type:"text","data-cy":"TodoTitleField",className:"todo__title-field",placeholder:"Empty todo will be deleted",ref:w,onChange:function(t){O(t.target.value)},onKeyUp:function(t){t.preventDefault(),"Enter"===t.key&&F(p),"Escape"===t.key&&(O(d),x(!1))},onBlur:function(){F(p)},value:p,disabled:_})}),_&&Object(u.jsxs)("div",{"data-cy":"TodoLoader",className:"modal overlay",children:[Object(u.jsx)("div",{className:"modal-background has-background-white-ter"}),Object(u.jsx)("div",{className:"loader"})]})]}):Object(u.jsx)("span",{onDoubleClick:function(){x(!0),O(d)},className:"todo__title","data-cy":"TodoTitle",children:d}),Object(u.jsx)("button",{type:"button",className:"todo__remove","data-cy":"TodoDelete","aria-label":"deleteTodo",onClick:L,children:"\xd7"}),A&&Object(u.jsxs)("div",{"data-cy":"TodoLoader",className:"modal overlay",children:[Object(u.jsx)("div",{className:"modal-background has-background-white-ter"}),Object(u.jsx)("div",{className:"loader"})]})]})},S=function(t){var e=t.todos,n=Object(c.useContext)(g).tempTodo;return Object(u.jsxs)("section",{className:"todoapp__main","data-cy":"TodoList",children:[e.map((function(t){return Object(u.jsx)(N,{todo:t},t.id)})),n&&Object(u.jsx)(N,{todo:n},null===n||void 0===n?void 0:n.id)]})},E=function(){var t=Object(c.useContext)(g),e=t.error,n=t.setError;return Object(u.jsxs)("div",{className:"notification is-danger is-light has-text-weight-normal",children:[Object(u.jsx)("button",{"data-cy":"HideErrorButton",type:"button",className:"delete",onClick:function(){return n(null)}}),e]})},A=function(t){var e=t.isEveryTodosCompleted,n=Object(c.useContext)(g),o=n.todoTitle,r=n.setTodoTitle,i=n.addTodo,a=n.setError,d=n.loading,f=n.todos,b=n.setTodos,m=Object(c.useState)(f.every((function(t){return t.completed}))),p=Object(j.a)(m,2),T=p[0],h=p[1],v=Object(c.useRef)(null);Object(c.useEffect)((function(){f.every((function(t){return t.completed}))?h(!0):h(!1)}),[f]);Object(c.useEffect)((function(){v.current&&!v.current.disabled&&v.current.focus()}));return Object(u.jsxs)("header",{className:"todoapp__header",children:[Object(u.jsx)("button",{type:"button",className:l()("todoapp__toggle-all text-invisible",{active:e}),"data-cy":"ToggleAllButton",onClick:function(){h(!T),b(f.map((function(t){return Object(s.a)(Object(s.a)({},t),{},{completed:!T})})))},children:" "}),Object(u.jsx)("form",{onSubmit:function(t){if(null===t||void 0===t||t.preventDefault(),!o.trim())return a(O.titleIsEmpty),void setTimeout((function(){return a(null)}),2e3);i(o.trim())},children:Object(u.jsx)("input",{"data-cy":"NewTodoField",type:"text",className:"todoapp__new-todo",placeholder:"What needs to be done?",ref:v,value:o,onChange:function(t){return r(t.target.value)},disabled:d})})]})},I=function(){var t=Object(c.useContext)(g),e=t.todos,n=t.setTodos,r=t.status,i=t.setStatus,a=t.error,d=t.setError;Object(c.useEffect)((function(){var t;(t=C,T("/todos?userId=".concat(t))).then(n).catch((function(){return d(O.cantLoadTodos)}))}),[n,d]);var l=Object(c.useCallback)((function(){return function(t){var e=t.todos;switch(t.status){case o.Active:return e.filter((function(t){return!t.completed}));case o.Completed:return e.filter((function(t){return t.completed}));default:return e}}({todos:e,status:r})}),[e,r]),s=Object(c.useMemo)((function(){return l()}),[l]),f=e.filter((function(t){return!t.completed})).length,j=e.some((function(t){return t.completed})),b=s.every((function(t){return t.completed}));return Object(u.jsxs)("div",{className:"todoapp",children:[Object(u.jsx)("h1",{className:"todoapp__title",children:"todos"}),Object(u.jsxs)("div",{className:"todoapp__content",children:[Object(u.jsx)(A,{isEveryTodosCompleted:b}),Object(u.jsx)(S,{todos:s}),e.length>0&&Object(u.jsx)(_,{uncompletedTodosCount:f,status:r,setStatus:i,isSomeTodosCompleted:j}),a&&e.length>0&&Object(u.jsx)(E,{})]})]})};a.a.render(Object(u.jsx)(r.a.StrictMode,{children:Object(u.jsx)(k,{children:Object(u.jsx)(I,{})})}),document.getElementById("root"))}},[[18,1,2]]]);
//# sourceMappingURL=main.6673fe9d.chunk.js.map